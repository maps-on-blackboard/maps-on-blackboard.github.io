<?xml version="1.0" encoding="utf-8" ?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Maps on Blackboard</title>
    <atom:link href="http://maps-on-blackboard.com/feed.xml" rel="self" type="application/rss+xml"></atom:link>
    <link>http://maps-on-blackboard.com</link>
    <description>Learn how to create online maps with lot of flexibility</description>
    <pubDate>Sat, 30 May 2015 20:00:00 -0400</pubDate>
    <generator>Wintersmith - https://github.com/jnordberg/wintersmith</generator>
    <language>en</language>
    <item>
      <title>Interective map for data visualisation</title>
      <link>http://maps-on-blackboard.com/articles/interactive-map/</link>
      <pubDate>Sat, 30 May 2015 20:00:00 -0400</pubDate>
      <guid isPermaLink="true">http://maps-on-blackboard.com/articles/interactive-map/</guid>
      <author></author>
      <description>&lt;p&gt;As conceptualized by me &lt;a href=&quot;http://maps-on-blackboard.com/articles/blog1-basic-map/&quot;&gt;earlier&lt;/a&gt; the different components of online maps creation are data, visual rendering, converter and interaction. Once again I’ll brief about these components here, but In this article we’ll see a nice example of interaction. We’ll visualize the &lt;a href=&quot;http://siteresources.worldbank.org/INTPROSPECTS/Resources/334934-1288990760745/Bilateral_Migration_Matrix_2013.xlsx&quot;&gt;bilateral migration&lt;/a&gt; ‘to’ and ‘from’ a country by tapping the desired country on map.&lt;/p&gt;
&lt;h2 id=&quot;-&quot;&gt; &lt;/h2&gt;
&lt;p&gt;Spatial (geographic) &lt;strong&gt;data&lt;/strong&gt; is foundation for the visualization and no doubt the information data is the cause for visualization. Information is the data that we want to show to user like population or GDP of countries and superimposing this data on maps makes information more readable. For spatial data &lt;a href=&quot;https://en.wikipedia.org/wiki/GeoJSON&quot;&gt;GeoJSON&lt;/a&gt; is suitable format as an extension of JSON.&lt;/p&gt;
&lt;p&gt;For &lt;strong&gt;rendering&lt;/strong&gt; of geometries, there are two options SVG and Canvas. SVG is more convenient for interaction and styling. With CSS itself you can change the style of a single SVG element. DOM events are supported on SVG elements.&lt;/p&gt;
&lt;p&gt;So now there is a need for &lt;strong&gt;converter&lt;/strong&gt; that converts GeoJSON to SVG. I am using &lt;a href=&quot;https://github.com/gagan-bansal/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt; for conversion. There are other tools like &lt;a href=&quot;http://jvectormap.com/documentation/gis-converter/&quot;&gt;jVectorMap Converter&lt;/a&gt;, but most of these are tightly integrated with the parent libraries. While geojson2svg output is collection of SVG strings for each geojson feature. These SVG strings can be added easily on browser. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Interaction&lt;/strong&gt; adds life to your visualization. Interaction is enlarging the map i.e. zooming or adding some behavior to each feature/geometry drawn on map. In this blog I’ll demonstrate the implementation of interaction on map using HTML, JavaScript and jQuery.  &lt;/p&gt;
&lt;p&gt;Here is the map with tap interaction. Countries &lt;a href=&quot;http://siteresources.worldbank.org/INTPROSPECTS/Resources/334934-1288990760745/Bilateral_Migration_Matrix_2013.xlsx&quot;&gt;bilateral migration data&lt;/a&gt; is visualized on the world map. Tapping any country on map shows other countries in different colors (yellow to brown gradient) based on the number of migration to/from these countries. &lt;strong&gt;Tap on any country (it turns green) to see to/from which countries people are moving.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;ul id=&quot;type&quot; class=&quot;type&quot;&gt;
  &lt;li &gt; &lt;input name=&quot;type&quot; id=&quot;source&quot; value=&quot;source&quot; type=&quot;radio&quot; checked&gt;&lt;span class=&quot;label&quot;&gt;Souce Countries&lt;/span&gt;
  &lt;li&gt; &lt;input name=&quot;type&quot; id=&quot;dest&quot; value=&quot;dest&quot; type=&quot;radio&quot;&gt;&lt;span class=&quot;label&quot;&gt;Destination Countries&lt;/span&gt;
&lt;/ul&gt;&lt;/p&gt;
&lt;p&gt;&lt;div id=&quot;mapArea&quot; style=&quot;width: 100%;border:1px solid #c0c0c0;&quot;&gt;
  &lt;svg id=&quot;map&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; x=&quot;0&quot; y=&quot;0&quot; &gt;
  &lt;/svg&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div id=&quot;legend&quot;&gt;
&lt;span id=&quot;less&quot;&gt;Few &lt;/span&gt;
&lt;span&gt;Many&lt;/span&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;./js/build.min.js&quot;&gt;&lt;/script&gt;
So now let’s analyze the code for the above map step by step. Here is the HTML code for the map:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-html&quot;&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;type&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;type&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt; &amp;gt;&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;type&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;source&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;source&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;radio&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;checked&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;label&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Souce Countries&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;type&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;dest&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;dest&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;radio&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;label&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Destination Countries&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;mapArea&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;width: 100%;border:1px solid #c0c0c0;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;svg&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;map&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;xmlns&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;http://www.w3.org/2000/svg&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;x&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;y&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;0&quot;&lt;/span&gt; &amp;gt;&lt;/span&gt;
   &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;svg&lt;/span&gt;&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;legend&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;less&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Few &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;Many&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;./js/build.min.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The above code is self explanatory, basically we created an empty SVG element here. On this SVG element we’ll add country polygons as SVG path element. At end I have included the JavaScript code and source for this is &lt;a href=&quot;https://github.com/maps-on-blackboard/interactive-map/blob/master/js/main.js&quot;&gt;js/main.js&lt;/a&gt; that we’ll analyze now.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;  &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; $ = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'jquery'&lt;/span&gt;),
  &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;   geojson2svg = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'geojson2svg'&lt;/span&gt;),
  &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;   parseSVG = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'parse-svg'&lt;/span&gt;),
  &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;   Rainbow = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'rainbowvis.js'&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;First we import the modules, &lt;a href=&quot;https://www.npmjs.com/package/jquery&quot;&gt;jQuery&lt;/a&gt; that helps a lot, &lt;a href=&quot;https://www.npmjs.com/package/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt; to convert GeoJSON (country geometry data) to SVG path elements, &lt;a href=&quot;https://www.npmjs.com/package/parse-svg&quot;&gt;parse-svg&lt;/a&gt; module to parse SVG string to DOM element and &lt;a href=&quot;https://www.npmjs.com/package/rainbowvis.js&quot;&gt;rainbowvis.js&lt;/a&gt; for making the color palette. We’ll see the usage of each module as we go through the code.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;  &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// get countires geojson data and migration data&lt;/span&gt;
  &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt; $.when(
  &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;   $.getJSON(&lt;span class=&quot;string&quot;&gt;'./data/countries.geo.json'&lt;/span&gt;),
  &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;   $.get(&lt;span class=&quot;string&quot;&gt;'./data/migration-matrix.csv'&lt;/span&gt;)
  &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt; ).then(drawGeoJSON, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;   console.log(&lt;span class=&quot;string&quot;&gt;'data not found'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt; })
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;With jQuery promise approach I fetch countries geojson data and migration matrix csv file. On success of both request the response data are passed to &lt;em&gt;drawGeoJSON&lt;/em&gt; function. This function basically process the GeoJSON and csv data. &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; migration = {},
 &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;   selCountry;
 &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt; $(&lt;span class=&quot;string&quot;&gt;'#mapArea'&lt;/span&gt;).on(&lt;span class=&quot;string&quot;&gt;'click'&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;'path'&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;   renderForCountry(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id,$(&lt;span class=&quot;string&quot;&gt;'input[name=type]:checked'&lt;/span&gt;).val());
 &lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;   selCountry = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id;
 &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; });
 &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt; $(&lt;span class=&quot;string&quot;&gt;'#type :radio'&lt;/span&gt;).on(&lt;span class=&quot;string&quot;&gt;'click'&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;   renderForCountry(selCountry,$(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).val());
 &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; });
 &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt; drawLegend();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here we define the global variables, &lt;em&gt;migration&lt;/em&gt; is json output for parsed csv file. Parsing is explained in detail in later section of this blog. &lt;em&gt;selCountry&lt;/em&gt; is selected country i.e. where user has tapped on the map. Next (line 14) I add an event listener on SVG path element (country geometry) using jQuery, here main callback function is &lt;em&gt;renderForCountry&lt;/em&gt;. Further at line 18 I add event listener to radio button that are used to change the type of movement i.e. to the countries (source) or from the countries (destination). &lt;em&gt;drawLegend&lt;/em&gt; is small function to make legend color palette below map. &lt;/p&gt;
&lt;p&gt;So there are three major functions &lt;em&gt;drawGeoJSON&lt;/em&gt;, &lt;em&gt;renderForCountry&lt;/em&gt; and &lt;em&gt;parseCSV&lt;/em&gt;. First I’ll discuss about the parsing of bilateral migration csv data.&lt;/p&gt;
&lt;p&gt;The table below is the sample from &lt;a href=&quot;https://github.com/maps-on-blackboard/interactive-map/blob/master/data/migration-matrix.csv&quot;&gt;migration data&lt;/a&gt;, I have saved xlsx to csv format with tab as delimiter. &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Destination country (across)  Afghanistan  Albania  Algeria  American Samoa  Andorra  Angola  Antigua and Barbuda  Argentina  Armenia  Aruba  Australia
  -Source country (down)      
Afghanistan                   0            0        0        0               0        0       0                    9          0        0      28411    
Albania                       0            0        0        0               0        0       0                    77         0        4      3063     
Algeria                       0            0        0        0               0        0       0                    210        0        3      1392     
American Samoa                0            0        0        0               0        0       0                    0          0        0      219      
Andorra                       0            0        0        0               0        0       0                    47         0        0      22       
Angola                        0            0        0        0               0        0       0                    81         0        0      546      
Antigua and Barbuda           0            0        0        0               0        0       0                    0          0        5      43       
Argentina                     0            0        0        0               708      0       0                    0          0        71     14832    
Armenia                       0            0        0        0               0        0       0                    939        0        0      1253     
Aruba                         0            0        0        0               0        0       5                    0          0        0      41       
Australia                     0            0        167      0               61       0       7                    1179       0        14     0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;I parse the csv data to json at client side and sample output is shown here:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;{
  &lt;span class=&quot;string&quot;&gt;&quot;unitedstateofamerica&quot;&lt;/span&gt;: {
    &lt;span class=&quot;string&quot;&gt;&quot;dest&quot;&lt;/span&gt;: [
      {&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;unitedkingdom&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;222201&lt;/span&gt;},
      {&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;uganda&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1060&lt;/span&gt;},
      ...
    ],
    &lt;span class=&quot;string&quot;&gt;&quot;source&quot;&lt;/span&gt;: [
      {&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;unitedkingdom&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;758919&lt;/span&gt;},
      {&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;uganda&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1060&lt;/span&gt;},
      ...
    ]
  },
  &lt;span class=&quot;string&quot;&gt;&quot;uganda&quot;&lt;/span&gt; :{
    &lt;span class=&quot;string&quot;&gt;&quot;dest&quot;&lt;/span&gt;: [...],
    &lt;span class=&quot;string&quot;&gt;&quot;source&quot;&lt;/span&gt;: [...]
  },
  ....
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now it is easy to understand the &lt;em&gt;parseCSV&lt;/em&gt; function. So CSV response string need to be split at new line to get rows. Then for each column record value (split row using tab) need to be pushed for each country’s &lt;em&gt;source&lt;/em&gt; and &lt;em&gt;dest&lt;/em&gt; array set.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;parseCSV&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(respString)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; matrix = {};
 &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; rows = respString.split(&lt;span class=&quot;regexp&quot;&gt;/\r\n|\r|\n/g&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;//first row is header&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;91&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; countries = rows[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].split(&lt;span class=&quot;string&quot;&gt;'\t'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;92&lt;/span&gt;   countries.forEach(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(name)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;93&lt;/span&gt;     matrix[name.toLowerCase().replace(&lt;span class=&quot;regexp&quot;&gt;/[^a-z0-9]/g&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;)]
 &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;       = {&lt;span class=&quot;string&quot;&gt;'dest'&lt;/span&gt;: [], &lt;span class=&quot;string&quot;&gt;'source'&lt;/span&gt;: []};
 &lt;span class=&quot;number&quot;&gt;95&lt;/span&gt;   });
 &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;   rows = rows.slice(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,rows.length);
 &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; counter =&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;
 &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;   rows.forEach(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(row)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;99&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; data = row.split(&lt;span class=&quot;string&quot;&gt;'\t'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;     &lt;span class=&quot;comment&quot;&gt;// first field is country name&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; countryRow = data[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].toLowerCase().replace(&lt;span class=&quot;regexp&quot;&gt;/[^a-z0-9]/g&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; i&amp;lt; data.length; i++) {
&lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;       &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; countryCol = countries[i].toLowerCase().replace(&lt;span class=&quot;regexp&quot;&gt;/[^a-z0-9]/g&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;       &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (countryRow !== countryCol) {
&lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;         &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; val = &lt;span class=&quot;built_in&quot;&gt;parseInt&lt;/span&gt;(data[i]);
&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;         matrix[countryCol][&lt;span class=&quot;string&quot;&gt;'source'&lt;/span&gt;].push({
&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;           name: countryRow, value: val});
&lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;         matrix[countryRow][&lt;span class=&quot;string&quot;&gt;'dest'&lt;/span&gt;].push({
&lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;           name: countryCol, value: val});
&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;       }
&lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;     }
&lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;   });
&lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; matrix;
&lt;span class=&quot;number&quot;&gt;114&lt;/span&gt; };
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we’ll discuss the function &lt;em&gt;drawGeoJSON&lt;/em&gt; that uses &lt;em&gt;converter&lt;/em&gt; geojson2svg for converting GeoJSON features (in our case country boundaries) to SVG path element. Lets go line by line carefully.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;23&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;drawGeoJSON&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(respGeojson,respMigration)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; geojson = respGeojson[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];
 &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;   migration = parseCSV(respMigration[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]);
 &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When both requests for geojson and migration data are successful then &lt;em&gt;drawGeoJOSN&lt;/em&gt; function is executed that is callback function to jQuery’s &lt;em&gt;when&lt;/em&gt; function. Each argument to callback function is array with following structure &lt;em&gt;[data, statusText, jqXHR]&lt;/em&gt;, check jQuery &lt;a href=&quot;https://api.jquery.com/jquery.when/&quot;&gt;documentation&lt;/a&gt;. Instead of jQuery you can use some other modules for ajax/promise like &lt;a href=&quot;https://www.npmjs.com/package/promise&quot;&gt;promise&lt;/a&gt; or &lt;a href=&quot;https://www.npmjs.com/package/superagent&quot;&gt;SuperAgent&lt;/a&gt;. Read more about &lt;a href=&quot;https://www.promisejs.org/&quot;&gt;promise&lt;/a&gt;. At line 25 we parse migration data that has been discussed above. &lt;/p&gt;
&lt;p&gt;Next we set width and height of the SVG element on this we are going to draw countries boundary.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// get the width and height of svg element.&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// as the width of the map container is 100%, we have to set the width and &lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// height of the svgElement as per the current width/height of the container.&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; container = document.getElementById(&lt;span class=&quot;string&quot;&gt;'mapArea'&lt;/span&gt;),
 &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;     width = container.offsetWidth,
 &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;     svgMap = document.getElementById(&lt;span class=&quot;string&quot;&gt;'map'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;   svgMap.setAttribute(&lt;span class=&quot;string&quot;&gt;'width'&lt;/span&gt;, width);
 &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;   svgMap.setAttribute(&lt;span class=&quot;string&quot;&gt;'height'&lt;/span&gt;, width * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// initiate geojson2svg &lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; convertor = geojson2svg(
 &lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;     {width: width, height: width * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;},
 &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;     {
 &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;       mapExtent: {left: -&lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, right: &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, bottom: -&lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, top: &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;}
 &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;     }
 &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;   );
 &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt; 
 &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// process every feature in geojson&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;   geojson.features.forEach(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(f)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; svgString = convertor.convert(
 &lt;span class=&quot;number&quot;&gt;46&lt;/span&gt;       f,
 &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;       {attributes: {
 &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;         id: f.properties.name.toLowerCase().replace(&lt;span class=&quot;regexp&quot;&gt;/[^a-z0-9]/g&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;),
 &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;         &lt;span class=&quot;string&quot;&gt;'class'&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;'nil'&lt;/span&gt;}
 &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;       }
 &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;     );
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://www.npmjs.com/package/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt; is initiated with svg element’s size (width &amp;amp; height) and maps coordinate system extent. Then feature (country) in geojson is converted to svg string with &lt;em&gt;.convert&lt;/em&gt; api. In &lt;em&gt;.convert&lt;/em&gt; function along with feature, attributes are also passed, here we pass country name as id. So output svg path element’s id would be country name. Here is sample svg path: &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;d&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;M48.64402566666665,141.04507866666665 48.35352855555553,
141.377...111124,38.13749934444445 46.57813694444443,37.077336044444436
 49.58739544444444,37.494978844444454Z&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;unitedstatesofamerica&quot;&lt;/span&gt; 
 &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;nil&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;path&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In next two lines SVG path string is converted to SVG DOM element using &lt;a href=&quot;https://www.npmjs.com/package/parse-svg&quot;&gt;parseSVG&lt;/a&gt; module and appended to root SVG element. Instead of &lt;em&gt;parseSVG&lt;/em&gt; you can use &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/DOMParser&quot;&gt;DOMparser&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; svg = parseSVG(svgString);
 &lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;     svgMap.appendChild(svg);
 &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;   });
 &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;   renderForCountry(&lt;span class=&quot;string&quot;&gt;'United States of America'&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;'source'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt; }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;At the end &lt;em&gt;renderforCountry&lt;/em&gt; is called to initially render the map. We’ll analyze now this simple function that basically change the fill color of SVG path elements of countries. Color is based on the number, if the number is more shade of brown is selected and if less towards yellow color is picked. Colors are picked with help a nice module &lt;a href=&quot;https://www.npmjs.com/package/rainbowvis.js&quot;&gt;rainbowvis.js&lt;/a&gt;. &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;renderForCountry&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(name,type)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;59&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; name = name.toLowerCase().replace(&lt;span class=&quot;regexp&quot;&gt;/[^a-z0-9]/g&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; countries = migration[name][type]
 &lt;span class=&quot;number&quot;&gt;61&lt;/span&gt;     .filter(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(c)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;62&lt;/span&gt;       &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; c.value != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;
 &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;     })
 &lt;span class=&quot;number&quot;&gt;64&lt;/span&gt;     .sort(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(a,b)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;       &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; a.value - b.value;
 &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;     });
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There are two arguments for this function country name and type i.e. source (‘source’) or destination (‘dest’). First name is formatted the way we are storing country name by converting to lower case removing all other character other than numbers and alphabets. Then I select the data (line 60) and filter (line 61) by removing countries where migration value is zero. Then (line 64) all countries are sorted based on the number of persons movement in ascending order.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; palette = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Rainbow();
 &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;   palette.setNumberRange(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,countries.length - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;   palette.setSpectrum(&lt;span class=&quot;string&quot;&gt;'#ffff85'&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;'#6b0000'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;   $(&lt;span class=&quot;string&quot;&gt;'#map path'&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;'class'&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;'nil'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;71&lt;/span&gt;   $(&lt;span class=&quot;string&quot;&gt;'#map path'&lt;/span&gt;).css(&lt;span class=&quot;string&quot;&gt;'fill'&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;''&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;   $(&lt;span class=&quot;string&quot;&gt;'#'&lt;/span&gt;+name).css(&lt;span class=&quot;string&quot;&gt;'fill'&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;'#70d035'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;   countries.forEach(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(country,i,arr)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;     $(&lt;span class=&quot;string&quot;&gt;'#'&lt;/span&gt;+country.name)
 &lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;       .css(&lt;span class=&quot;string&quot;&gt;'fill'&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;'#'&lt;/span&gt;+palette.colorAt(i));
 &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;   });
 &lt;span class=&quot;number&quot;&gt;77&lt;/span&gt; }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now the main thing, we need to assign colors to countries. I have done &lt;a href=&quot;http://www.ncgia.ucsb.edu/cctp/units/unit47/html/comp_class.html&quot;&gt;quantile classification&lt;/a&gt; here (whereas each category is having only one unit). Basically we want a palette with color gradient of length equal to the number of countries for a given set, so that we can pick the color for each country in &lt;em&gt;countries&lt;/em&gt; data set in ascending order. Colors in color palette need to be depicting first color for few persons and graduating to last color depicting many, so light color shade to dark color would suffice here. &lt;a href=&quot;https://www.npmjs.com/package/rainbowvis.js&quot;&gt;rainbowvis.js&lt;/a&gt; module is very helpful for making such color palette. After initiating the &lt;em&gt;Rainbow&lt;/em&gt; instance &lt;em&gt;palette&lt;/em&gt; (line 67) we need to set the number of colors in palette (line 68) and color shades (line 69). Initially render all countries with &lt;em&gt;nil&lt;/em&gt; call as set css fill empty (line 70 and 71). Now color the selected country (where user tapped) green (line 72). And for each country in &lt;em&gt;countries&lt;/em&gt; data array set the fill color by picking from &lt;em&gt;palette&lt;/em&gt; for given index.&lt;/p&gt;
&lt;p&gt;This way you have easily created the interactive thematic map for migration data visualization. The map included in this blog is svg map generated from the above code.  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note: Each article in this blog is an individual project. Here is the &lt;a href=&quot;https://github.com/maps-on-blackboard/interactive-map&quot;&gt;source code&lt;/a&gt; for this article map.&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Map of web mercator tiles</title>
      <link>http://maps-on-blackboard.com/articles/web-mercator-tiles-map/</link>
      <pubDate>Tue, 14 Apr 2015 20:00:00 -0400</pubDate>
      <guid isPermaLink="true">http://maps-on-blackboard.com/articles/web-mercator-tiles-map/</guid>
      <author></author>
      <description>&lt;p&gt;A lot of processing is required to create raster map tiles at back end. Yes there are many steps with many software to generate OSM tiles with road data. But on the other hand consuming these map tiles is very easy at browser end. We’ll see in this blog how easy it is to display map of reqired area with raster map tile in perticular for spherical mercator commanly known as web mercator projection. &lt;/p&gt;
&lt;h2 id=&quot;-&quot;&gt; &lt;/h2&gt;
&lt;p&gt;Here is the map with web mercator image tiles using npm module &lt;a href=&quot;https://www.npmjs.com/package/web-mercator-tiles&quot;&gt;web-mercator-tiles&lt;/a&gt;. You can change the center and zoom of this map. In the current example map can not be dragged or zoomed, the idea is to show the calculation of map tiles at proper place.&lt;/p&gt;
&lt;p&gt;&lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
&lt;span&gt; Center (long, lat) &lt;/span&gt;&lt;input type=&quot;text&quot; id=&quot;center&quot; value=&quot;-71.147, 42.472&quot;/&gt;
&lt;span&gt; Zoom &lt;/span&gt; &lt;input type=&quot;number&quot; id=&quot;zoom&quot; value=&quot;12&quot; style=&quot;width:50px&quot; /&gt;&lt;input id=&quot;zoomTo&quot; type=&quot;button&quot; value=&quot;Zoom&quot;/&gt;&lt;/p&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;./js/build.min.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;Let’s understand the approach for this map. So the requirement is to display a map for a given location and zoom level. &lt;/p&gt;
&lt;p&gt;First extent of the map need to be calculated in projected coordinate system (in our case spherical mercator) for a map’s div size and desired center and zoom level. Now npm module &lt;a href=&quot;https://www.npmjs.com/package/web-mercator-tiles&quot;&gt;web-mercator-tiles&lt;/a&gt; can be used to get the list of tiles for given projected extent and zoom. Each tile of this set has tile’s Z,X,Y properties and top, left with respect to map div. And now its quite easy to display all the map tile images as image tag in map div from any map provider (OSM, MapBox and yes google, bing also).&lt;/p&gt;
&lt;p&gt;We’ll see now the code in detail. First the HTML component of this example:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-html&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;map&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt; Center (long, lat) &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;center&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;-71.147, 42.472&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt; Zoom &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt; 
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;number&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;zoom&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;12&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;width:50px&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;zoomTo&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;button&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;value&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;Zoom&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;./js/build.min.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The main logic (JavaScript code) for this map is in &lt;a href=&quot;https://github.com/maps-on-blackboard/web-mercator-tiles-map/blob/master/js/main.js&quot;&gt;main.js&lt;/a&gt; file that is part of &lt;a href=&quot;http://github.com/gagan-bansal/web-mercator-tiles&quot;&gt;this repo&lt;/a&gt;. So here goes the code step by step.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; webMercatorTiles = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'web-mercator-tiles'&lt;/span&gt;),
&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;   SphericalMercator = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'sphericalmercator'&lt;/span&gt;),
&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;   baseURL = &lt;span class=&quot;string&quot;&gt;'http://tile.openstreetmap.org'&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;   mercatorMaxRes = &lt;span class=&quot;number&quot;&gt;156543.03392804097&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;   mapDiv, size;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;First we &lt;em&gt;require&lt;/em&gt; the npm modules. &lt;a href=&quot;https://www.npmjs.com/package/web-mercator-tiles&quot;&gt;web-mercator-tiles&lt;/a&gt; module to get the tiles for given map extent and &lt;a href=&quot;https://www.npmjs.com/package/sphericalmercator&quot;&gt;sphericalmercator&lt;/a&gt; to transform geographic coordinates to spherical/web mercator projection. As OSM tiles url pattern is &lt;code&gt;http://tile.openstreetmap.org/{z}/{X}/{Y}.png&lt;/code&gt; so we defined the baseURL at line 3. Mercator projection extent divided by tile size (256) will give the maximum resolution i.e. zoom level 0 resolution.&lt;/p&gt;
&lt;p&gt;Next we calculate the map’s div size.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// get map window size&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt; mapDiv = document.getElementById(&lt;span class=&quot;string&quot;&gt;'map'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; size = {
 &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;   height: &lt;span class=&quot;built_in&quot;&gt;parseInt&lt;/span&gt;(mapDiv.clientHeight),
&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;   width: &lt;span class=&quot;built_in&quot;&gt;parseInt&lt;/span&gt;(mapDiv.clientWidth)
&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt; };
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we create an instance of SphericalMercator that is projection transformer. To change the map area and zoom I created a button and assigned function &lt;code&gt;zoomTo&lt;/code&gt;. And on page load we call our &lt;code&gt;zoomTo&lt;/code&gt; function that is the main function to load the tiles. &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// projection tranformer instace&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt; merc = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SphericalMercator({size:&lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;});
&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// add event listenre to 'zoomTo' button&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt; document.getElementById(&lt;span class=&quot;string&quot;&gt;'zoomTo'&lt;/span&gt;).addEventListener(&lt;span class=&quot;string&quot;&gt;'click'&lt;/span&gt;, zoomTo);
&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// call zoomTo funcion on page load&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt; zoomTo();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;zoomTo function:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;zoomTo&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; {&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; center = document.getElementById(&lt;span class=&quot;string&quot;&gt;'center'&lt;/span&gt;).value.split(&lt;span class=&quot;string&quot;&gt;','&lt;/span&gt;),
&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;     zoom =  &lt;span class=&quot;built_in&quot;&gt;parseInt&lt;/span&gt;(document.getElementById(&lt;span class=&quot;string&quot;&gt;'zoom'&lt;/span&gt;).value),
&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;     mercCenter, mapExtent, res, tiles;
&lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// calculate map parameters in mercator projection&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;   mercCenter = merc.forward([&lt;span class=&quot;built_in&quot;&gt;parseFloat&lt;/span&gt;(center[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]),&lt;span class=&quot;built_in&quot;&gt;parseFloat&lt;/span&gt;(center[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;])]);
&lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;   res = mercatorMaxRes/&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.pow(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,zoom);
&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;   mapExtent = {
&lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;     left: mercCenter[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] - size.width/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * res,
&lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;     right: mercCenter[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + size.width/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * res,
&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;     bottom: mercCenter[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - size.height/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * res,
&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;     top: mercCenter[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] + size.height/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * res
&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;   };
&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// get map tiles list for our map extent&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;   tiles = webMercatorTiles(mapExtent, zoom);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As we discussed in the approach extent (web/spehrical mercator) of the map is required for &lt;a href=&quot;https://www.npmjs.com/package/web-mercator-tiles&quot;&gt;web-mercator-tiles&lt;/a&gt; module. So we calcualte center of the map in mercator projection at line 24. Then resolution for given zoom is calculated at line 25. Now its quite easy to get projected map extent with respect to the center and give map’s div size. Pass the map extent and zoom to &lt;code&gt;webMercatorTile&lt;/code&gt; function to get the tiles details. Here is example of tile object:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;{
  &lt;span class=&quot;string&quot;&gt;&quot;X&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1237&lt;/span&gt;,
  &lt;span class=&quot;string&quot;&gt;&quot;Y&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;1512&lt;/span&gt;,
  &lt;span class=&quot;string&quot;&gt;&quot;Z&quot;&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;,
  &lt;span class=&quot;string&quot;&gt;&quot;top&quot;&lt;/span&gt;:-&lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;,
  &lt;span class=&quot;string&quot;&gt;&quot;left&quot;&lt;/span&gt;:-&lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;top&lt;/code&gt; and &lt;code&gt;left&lt;/code&gt; are with respect to map’s div. Its quite easy now to append each map image tile as &lt;code&gt;img&lt;/code&gt; tag in map’s div.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// append map tile images to the map div&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;   mapDiv.innerHTML = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;
&lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;   tiles.forEach(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(t)&lt;/span&gt; {&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; img = document.createElement(&lt;span class=&quot;string&quot;&gt;'img'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;     img.src = baseURL + &lt;span class=&quot;string&quot;&gt;'/'&lt;/span&gt;+ t.Z + &lt;span class=&quot;string&quot;&gt;'/'&lt;/span&gt; + t.X + &lt;span class=&quot;string&quot;&gt;'/'&lt;/span&gt; + t.Y + &lt;span class=&quot;string&quot;&gt;'.png'&lt;/span&gt;;
&lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;     img.setAttribute(&lt;span class=&quot;string&quot;&gt;'style'&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;'left:'&lt;/span&gt;+ t.left + &lt;span class=&quot;string&quot;&gt;'px;top:'&lt;/span&gt;+t.top+&lt;span class=&quot;string&quot;&gt;'px;'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;     img.setAttribute(&lt;span class=&quot;string&quot;&gt;'class'&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;'tile'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;     mapDiv.appendChild(img);
&lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;   });
&lt;span class=&quot;number&quot;&gt;43&lt;/span&gt; }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And we are done.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Future:&lt;/strong&gt; While writing this blog I was thinking that its not difficult to modify &lt;a href=&quot;http://github.com/gagan-bansal/web-mercator-tiles&quot;&gt;web-mercator-tiles&lt;/a&gt; for making it generic. Generic here I mean for any projection. Right  now itself projection transformer is not part of this module and I can initiate the instance with  projection extent and maximum resolution. Then the tiles detail can be calculated easily for any projection. &lt;strong&gt;Update:&lt;/strong&gt; Here is the generic map tiles calculation module &lt;a href=&quot;https://www.npmjs.com/package/map-the-tiles&quot;&gt;map-the-tiles&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Other basic functionality of any map is navigation. &lt;code&gt;pan&lt;/code&gt; and &lt;code&gt;zoom&lt;/code&gt; can also be achieved using some gesture library. I am thinking of using &lt;a href=&quot;http://hammerjs.github.io/&quot;&gt;hammer.js&lt;/a&gt;. Certainly I’ll try this as my next exercise.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note: Each article in this blog is an individual project. Here is the &lt;a href=&quot;https://github.com/maps-on-blackboard/web-mercator-tiles-map&quot;&gt;source code&lt;/a&gt; for this article. In the source repository there are maps[n].html files that are used to show maps in the blog.&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Thematic map with geojson2svg</title>
      <link>http://maps-on-blackboard.com/articles/blog2-thematic-map/</link>
      <pubDate>Sat, 14 Mar 2015 20:00:00 -0400</pubDate>
      <guid isPermaLink="true">http://maps-on-blackboard.com/articles/blog2-thematic-map/</guid>
      <author></author>
      <description>&lt;p&gt;In my previous blog &lt;a href=&quot;http://maps-on-blackboard.com/articles/blog1-basic-map/&quot;&gt;Basic map with geojson2svg&lt;/a&gt; we have seen that how easily we can create svg world map using &lt;a href=&quot;https://github.com/gagan-bansal/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt;. The previous map was a basic map without any information of any country. Now we are going to create world population map showing low, medium and high population countries with different colors. &lt;/p&gt;
&lt;h2 id=&quot;-&quot;&gt; &lt;/h2&gt;
&lt;p&gt;First I am showing the output, countries population thematic map color-coded as low, medium and high.&lt;/p&gt;
&lt;p&gt;&lt;ul id=&quot;legend&quot;&gt;
  &lt;li&gt; &lt;span class=&quot;box l&quot;&gt;&lt;/span&gt;&lt;span class=&quot;label&quot;&gt;Low&lt;/span&gt;
  &lt;li&gt; &lt;span class=&quot;box m&quot;&gt;&lt;/span&gt;&lt;span class=&quot;label&quot;&gt;Medium&lt;/span&gt;
  &lt;li&gt; &lt;span class=&quot;box h&quot;&gt;&lt;/span&gt;&lt;span class=&quot;label&quot;&gt;High&lt;/span&gt;
&lt;/ul&gt;&lt;/p&gt;
&lt;p&gt;&lt;div id=&quot;mapArea&quot; style=&quot;width: 100%;height:50%;border: 1px solid #c0c0c0;&quot;&gt; 
  &lt;svg id=&quot;map&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; x=&quot;0&quot; y=&quot;0&quot; &gt;
  &lt;/svg&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;./js/build.min.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;Now the approach for the map creation is assemble the data (geojson and population) then convert to svg and render on maps with styles required.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Please clone the project &lt;a href=&quot;https://github.com/maps-on-blackboard/blog2-thematic-map/&quot;&gt;blog2-thematic-map&lt;/a&gt; so that while going through this blog you can execute also.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Code below shows the HTML component from &lt;a href=&quot;https://github.com/maps-on-blackboard/blog2-thematic-map/blob/master/map1.html&quot;&gt;map1.html&lt;/a&gt; for the above map. &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&amp;lt;ul id=&lt;span class=&quot;string&quot;&gt;&quot;legend&quot;&lt;/span&gt;&amp;gt;
  &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;box l&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;label&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Low&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;box m&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;label&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Medium&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;box h&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;label&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;High&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;mapArea&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;width: 100%;height:50%;border: 1px solid #c0c0c0;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt; 
  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;svg&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;map&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;xmlns&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;http://www.w3.org/2000/svg&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;x&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;y&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;0&quot;&lt;/span&gt; &amp;gt;&lt;/span&gt;
  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;svg&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;./js/build.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’ll discuss each step of the JavaScript code &lt;a href=&quot;https://github.com/maps-on-blackboard/blog2-thematic-map/blob/master/js/main.js&quot;&gt;main.js&lt;/a&gt; in detail, the first is the data i.e. geographic boundaries of countries and population of each country. As discussed in the last blog, geojson is well suited for countries’ boundaries. Though geojson has a structure to store the attributes of the feature like population, I prefer to store the feature information in a separate json file. Advantage is that we have to maintain just one geojson file and any information can be linked at run time. To join geojson with json I am using module &lt;a href=&quot;https://www.npmjs.com/package/extend-geojson-properties&quot;&gt;extend-geojson-properties&lt;/a&gt;. Let’s see the code now:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; $ = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'jquery'&lt;/span&gt;),
 &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;   geojson2svg = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'geojson2svg'&lt;/span&gt;),
 &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;   parseSVG = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'parse-svg'&lt;/span&gt;),
 &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;   extendGeoJSON = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'extend-geojson-properties'&lt;/span&gt;);
 &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; 
 &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// get countires geojson data and population data&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt; $.when(
 &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;   $.getJSON(&lt;span class=&quot;string&quot;&gt;'./data/countries.geo.json'&lt;/span&gt;),
 &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;   $.getJSON(&lt;span class=&quot;string&quot;&gt;'./data/population.json'&lt;/span&gt;)
&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; ).then(drawGeoJSON, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; {&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;   console.log(&lt;span class=&quot;string&quot;&gt;'data not found'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt; })
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In first four lines we just include the modules that we &lt;em&gt;require&lt;/em&gt;. Then with ajax’ &lt;em&gt;promise&lt;/em&gt; approach I fetch geojson and population json data. The response from the both request are passed in &lt;em&gt;drawGeoJSON&lt;/em&gt; function. Next in &lt;em&gt;drawGeoJSON&lt;/em&gt; function we’ll see how to join the geojson and json data.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;drawGeoJSON&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(respGeojson,respPopulation)&lt;/span&gt; {&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; geojson = respGeojson[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;],
&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;     population = respPopulation[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];
&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// extend geojson properties with country's population&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; joinMap = {
&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;     geoKey: &lt;span class=&quot;string&quot;&gt;'properties.name'&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;     dataKey: &lt;span class=&quot;string&quot;&gt;'countryName'&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;   };
&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;   extendGeoJSON(geojson,population.countries,joinMap);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In jQuery’s ajax response objects &lt;em&gt;respGeojson&lt;/em&gt; and &lt;em&gt;respPopulation&lt;/em&gt;, zeroth value is &lt;em&gt;data&lt;/em&gt;. Now we need to join the geojson and population data. &lt;a href=&quot;https://www.npmjs.com/package/extend-geojson-properties&quot;&gt;extend-geojson-properties&lt;/a&gt; is very simple module for this purpose, we have to just specify the joining keys for each in &lt;em&gt;joinMap&lt;/em&gt;. This module is function that accepts parameters, first - geojson (&lt;em&gt;geojson&lt;/em&gt;), second - json data set (&lt;em&gt;population&lt;/em&gt;) and third - object of join keys (&lt;em&gt;joinMap&lt;/em&gt;). The function extends all the json fields of json data set to geojson properties object. You can read more about extend-geojson-properties module &lt;a href=&quot;https://github.com/gagan-bansal/extend-geojson-properties&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now we need to convert geojson to svg:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// get the width and height of svg element.&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// as the width of the map container is 100%, we have to set the width and &lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// height of the svgElement as per the current width/height of the container.&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; container = document.getElementById(&lt;span class=&quot;string&quot;&gt;'mapArea'&lt;/span&gt;),
&lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;     width = container.offsetWidth,
&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;     svgMap = document.getElementById(&lt;span class=&quot;string&quot;&gt;'map'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;   svgMap.setAttribute(&lt;span class=&quot;string&quot;&gt;'width'&lt;/span&gt;, width);
&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;   svgMap.setAttribute(&lt;span class=&quot;string&quot;&gt;'height'&lt;/span&gt;, width * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// initiate geojson2svg &lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; convertor = geojson2svg(
&lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;     {width: width, height: width * &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;},
&lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;     {
&lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;       mapExtent: {
&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;         left: -&lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;         right: &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;         bottom: -&lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;         top: &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;       }
&lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;     }
&lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;   );
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the above code we initialize the &lt;a href=&quot;https://www.npmjs.com/package/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt; instance as explained in the last blog &lt;a href=&quot;http://maps-on-blackboard.com/articles/blog1-basic-map/&quot;&gt;Basic map with geojson2svg&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Next we categorize every feature according to the population and convert to svg by assigning css class accordingly.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// process every feature&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;   geojson.features.forEach(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(f)&lt;/span&gt; {&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;46&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; popCat, svgString, svg;
&lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (f.properties.population &amp;lt;= &lt;span class=&quot;number&quot;&gt;30000000&lt;/span&gt;) {
&lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;       popCat = &lt;span class=&quot;string&quot;&gt;'low'&lt;/span&gt;;
&lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;     } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( f.properties.population &amp;gt; &lt;span class=&quot;number&quot;&gt;30000000&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;     &amp;amp;&amp;amp; f.properties.population &amp;lt;= &lt;span class=&quot;number&quot;&gt;60000000&lt;/span&gt;) {
&lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;       popCat = &lt;span class=&quot;string&quot;&gt;'medium'&lt;/span&gt;;
&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;     } &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {
&lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;       popCat = &lt;span class=&quot;string&quot;&gt;'high'&lt;/span&gt;;
&lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;     }
&lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;     svgString = convertor.convert(
&lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;       f,
&lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;       {attributes: {&lt;span class=&quot;string&quot;&gt;'class'&lt;/span&gt;: popCat}});
&lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;     svg = parseSVG(svgString);
&lt;span class=&quot;number&quot;&gt;59&lt;/span&gt;     svgMap.appendChild(svg);
&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;   });
&lt;span class=&quot;number&quot;&gt;61&lt;/span&gt; }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For each feature we first check to which category the feature belongs. Once we get the category (&lt;em&gt;popCat&lt;/em&gt;) feature is converted to svg string (&lt;em&gt;svgString&lt;/em&gt;) by &lt;em&gt;convert&lt;/em&gt;  function. Two parameters are passed to this function first - feature (&lt;em&gt;f&lt;/em&gt;) and second options. In options here we are passing the svg class name that will apply the style to svg according to population category (line no 57). Here &lt;em&gt;attributes&lt;/em&gt; are the attributes of svg DOM element, we can pass any attribute while converting the geojson as per our requirement. Next (line 58) with &lt;em&gt;parse-svg&lt;/em&gt; module svg string is converted to svg DOM element and then appended to main svg element (&lt;em&gt;svgMap&lt;/em&gt;). And we are done, our thematic map is ready.  &lt;/p&gt;
&lt;p&gt;The map included in this blog is svg map generated from the above code.  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note: Each article in this blog is an individual project. Here is the &lt;a href=&quot;https://github.com/maps-on-blackboard/blog2-thematic-map/&quot;&gt;source code&lt;/a&gt; for this article. In the source repository there are maps[n].html files that are used to show maps in the blog.&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Basic map with geojson2svg</title>
      <link>http://maps-on-blackboard.com/articles/blog1-basic-map/</link>
      <pubDate>Thu, 05 Mar 2015 19:00:00 -0500</pubDate>
      <guid isPermaLink="true">http://maps-on-blackboard.com/articles/blog1-basic-map/</guid>
      <author></author>
      <description>&lt;p&gt;Now a days its very easy to publish a map using online API like Google maps or using open framework OpenLayers or Leaflet with OSM data. Mapbox and CartoDB make the map publishing even more simplified. So where does this tool &lt;a href=&quot;https://github.com/gagan-bansal/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt; stands in mapping domain?&lt;/p&gt;
&lt;h2 id=&quot;-&quot;&gt; &lt;/h2&gt;
&lt;p&gt;To understand this first let us go through the components involved in online maps publishing. Here we are considering only maps creation or rendering on browser with HTML, JavaScript and SVG. Maps publishing with static image tiles is different concept, map created with Mapbox is an example of this. Here is an &lt;a href=&quot;http://www.nytimes.com/2014/08/16/upshot/mapping-migration-in-the-united-states-since-1900.html?abt=0002&amp;amp;abg=0&quot;&gt;example&lt;/a&gt; of online map using JavaScript components by The New York Times. So there are different scenarios where each of the method has advantages over other. Generally for data visualization on maps JavaScript components are preferred due to dynamic rendering and  interaction capabilities .&lt;/p&gt;
&lt;p&gt;Now let us break up the map publishing with JavaScript into different components. The first one is geographic data itself, there are many open data source for spatial data. Important thing is the format that is supported by JavaScript and obvious choice is GeoJSON. Third (yes second after this) component is rendering of geographic or geometry features. To draw geometry features, SVG supports all type of shapes and styling functionality as well. Now the only thing required is conversion from GeoJSON to SVG, yes this is the second component.  &lt;a href=&quot;https://github.com/gagan-bansal/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt; serves this purpose. There is forth and the last component navigation i.e. zoom and pan. To visualize the data of higher depth map navigation helps a lot like showing population for different administrative levels. &lt;/p&gt;
&lt;p&gt;In this blog series I will demonstrate how a map can be published with different open source modules keeping in mind above mentioned four components. This approach gives flexibility to developers to choose and play with the component of their choice like there are many SVG tools and library for drawing and styling. Easily different animations also can be achieved.&lt;/p&gt;
&lt;p&gt;To start with here we&lt;single quote&gt;ll draw a plain map using geojson. Here is the map container div:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-html&quot;&gt;1 &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;mapArea&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;blackboard&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;width: 100%;border: 1px solid #c0c0c0;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt; 
2   &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;svg&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;map&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;xmlns&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;http://www.w3.org/2000/svg&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;width&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;100%&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;x&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;y&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;0&quot;&lt;/span&gt; &amp;gt;&lt;/span&gt;
4   &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;svg&lt;/span&gt;&amp;gt;&lt;/span&gt;
5 &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;
6 &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;./js/build.min.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;div#mapArea&lt;/code&gt; is map container div and &lt;code&gt;svg#map&lt;/code&gt; is the actual svg where We’ll add features. &lt;code&gt;build.min.js&lt;/code&gt; is the file containing our all code including the modules required. But our main file is &lt;a href=&quot;https://github.com/maps-on-blackboard/maps-on-blackboard.github.io/blob/master/src/contents/articles/basic-map/js/main.js&quot;&gt;main.js&lt;/a&gt; that contains the actual code you need to write for map publishing. So now I&lt;single quote&gt;ll explain the code in &lt;code&gt;main.js&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;First we have to get the geojson. Jquery getJSON is simple and very useful method for this.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; $ = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'jquery'&lt;/span&gt;),
&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;  geojson2svg = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'geojson2svg'&lt;/span&gt;),
&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;  parseSVG = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'parse-svg'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;// get wountires geojson data&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;  $.getJSON(&lt;span class=&quot;string&quot;&gt;'./data/countries.geo.json'&lt;/span&gt;,drawGeoJSON);
&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;First three lines are for the modules that we &lt;em&gt;&lt;strong&gt;require&lt;/strong&gt;&lt;/em&gt; for this code, wherever these are used I&lt;single quote&gt;ll explain.&lt;/p&gt;
&lt;p&gt;Next we fetch countries’ boundaries (MultyPolygon) geojson using Jquery &lt;code&gt;getJSON&lt;/code&gt; method. &lt;code&gt;drawGeoJSON&lt;/code&gt; is callback function. Following is the code for &lt;code&gt;drawGeoJSON&lt;/code&gt; &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt; &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;drawGeoJSON&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(geojson)&lt;/span&gt; {&lt;/span&gt;
 &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt; 
&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// get the width and height of svg element.&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// as the width of the map container is 100%, we have to set the width and &lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// height of the svgElement as per the current width/height of the container.&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; container = document.getElementById(&lt;span class=&quot;string&quot;&gt;'mapArea'&lt;/span&gt;),
&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;     width = container.offsetWidth,
&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;     svgMap = document.getElementById(&lt;span class=&quot;string&quot;&gt;'map'&lt;/span&gt;);
&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;   svgMap.setAttribute(&lt;span class=&quot;string&quot;&gt;'width'&lt;/span&gt;, width);
&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;   svgMap.setAttribute(&lt;span class=&quot;string&quot;&gt;'height'&lt;/span&gt;, width*&lt;span class=&quot;number&quot;&gt;.5&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Map container and svg container width has to be responsive. I mean width of the map should be according to device width and proportionately I set the map height. &lt;/p&gt;
&lt;p&gt;Now second component i.e. conversion of geojson to SVG. For this I am using the module &lt;a href=&quot;https://www.npmjs.com/package/geojson2svg&quot;&gt;geojson2svg&lt;/a&gt;.  &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// convert geojson to svg string &lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; convertor = geojson2svg(
&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;     {width: width, height: width},
&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;     {
&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;       attributes: {
&lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;         &lt;span class=&quot;string&quot;&gt;'style'&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;'stroke:#006600; fill: #F0F8FF;stroke-width:0.5px;'&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;       },
&lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;       mapExtent: {
&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;         left: -&lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;         right: &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;         bottom: -&lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;,
&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;         top: &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;       }
&lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;     }
&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;   );
&lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;   &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; svgStrings = convertor.convert(geojson);
&lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To initiate an instance of geojson2svg first parameter(line 20) is svg viewport size and the second object of options. First option &lt;em&gt;&lt;strong&gt;attributes&lt;/strong&gt;&lt;/em&gt; (line 22) is svg attributes here we are passing svg polygon &lt;em&gt;&lt;strong&gt;style&lt;/strong&gt;&lt;/em&gt; that will be attached to each country path(svg node path). Second option is &lt;em&gt;&lt;strong&gt;mapExtent&lt;/strong&gt;&lt;/em&gt; (line 25) i.e. very clear map extent. &lt;em&gt;&lt;strong&gt;convert&lt;/strong&gt;&lt;/em&gt; API of geojson2svg convert the geojson to array of SVG path strings. I’ll describe in detail geojson2svg module a later blog.&lt;/p&gt;
&lt;p&gt;Now for rendering on the map each SVG string has to be converted into DOM elements. For this I am using a module &lt;a href=&quot;https://www.npmjs.com/package/parse-svg&quot;&gt;parse-svg&lt;/a&gt; and each svg DOM element is appended to main SVG element.   &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-javascript&quot;&gt;&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;// parse each svg string and append to svg element &lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;   svgStrings.forEach(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(svgStr)&lt;/span&gt; {&lt;/span&gt;
&lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;     &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; svg = parseSVG(svgStr);
&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;     svgMap.appendChild(svg);
&lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;   });
&lt;span class=&quot;number&quot;&gt;42&lt;/span&gt; }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And here is our simple map of countries that we created using geojson2svg.&lt;/p&gt;
&lt;p&gt;&lt;div id=&quot;mapArea&quot; class=&quot;blackboard&quot; style=&quot;width: 100%;height:50%;border: 1px solid #c0c0c0;&quot;&gt; 
  &lt;svg id=&quot;map&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;
    width=&quot;100%&quot; height=&quot;50%&quot; x=&quot;0&quot; y=&quot;0&quot; &gt;
  &lt;/svg&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;./js/build.min.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;This map is actual map generated from the above code, please check this page source code. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note: Each article in this blog is an individual project. Here is the &lt;a href=&quot;https://github.com/maps-on-blackboard/blog1-basic-map/&quot;&gt;source code&lt;/a&gt; for this article. In the source repository there are maps[n].html files that are used to show maps in the blog.&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
  </channel>
</rss>